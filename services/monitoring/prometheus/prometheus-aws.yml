scrape_configs:
  # SIMCORE -------------------------------------------------------------------
  - job_name: "simcore"
    relabel_configs:
      - source_labels: [__meta_dns_name]
        regex: ^(.*?)[_-].*$
        replacement: $1
        target_label: deployment
      - source_labels: [__meta_dns_name]
        regex: ^.*?[_-](.*)$
        replacement: $1
        target_label: service_name
    dns_sd_configs:
      - names:
          - "production_webserver"
          - "staging_webserver"
        type: "A"
        port: 8080
      - names:
          - "production_storage"
          - "staging_storage"
        type: "A"
        port: 8080
      - names:
          - "production_director"
          - "staging_director"
        type: "A"
        port: 8080
      - names:
          - "production_rabbit"
          - "staging_rabbit"
        type: "A"
        port: 15692
      - names:
          - "production_traefik"
          - "staging_traefik"
        type: "A"
        port: 8082
      - names:
          - "redis-exporter"
          - "redis-exporter"
        type: "A"
        port: 9121
      - names:
          - "postgres-exporter"
          - "postgres-exporter"
        type: "A"
        port: 9187
