{"meta": {"type": "db", "canSave": true, "canEdit": true, "canAdmin": true, "canStar": true, "slug": "metrics", "url": "/grafana/d/X_99jTHWk/metrics", "expires": "0001-01-01T00:00:00Z", "created": "2021-12-06T18:22:59Z", "updated": "2021-12-06T18:24:46Z", "updatedBy": "admin", "createdBy": "admin", "version": 2, "hasAcl": false, "isFolder": false, "folderId": 3, "folderTitle": "simcore", "folderUrl": "/grafana/dashboards/f/n-tgNKhnz/simcore", "provisioned": false, "provisionedExternalId": ""}, "dashboard": {"annotations": {"list": [{"builtIn": 1, "datasource": "-- Grafana --", "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard"}]}, "description": "Simcore metrics", "editable": true, "gnetId": null, "graphTooltip": 0, "id": 13, "iteration": 1611819691845, "links": [{"$$hashKey": "object:183", "icon": "external link", "tags": [], "targetBlank": true, "title": "production postgres", "tooltip": "Open adminer", "type": "link", "url": "https://monitoring.osparc-master.speag.com/adminer/?pgsql=production_postgres&username=scu&db=simcoredb&ns=public"}, {"$$hashKey": "object:244", "icon": "external link", "tags": [], "targetBlank": true, "title": "staging postgres", "tooltip": "Open Adminer", "type": "link", "url": "https://monitoring.osparc-master.speag.com/adminer/?pgsql=staging_postgres&username=scu&db=simcoredb&ns=public"}], "meta": {"canAdmin": true, "canEdit": true, "canSave": true, "canStar": true, "created": "2020-10-09T13:28:12Z", "createdBy": "Anonymous", "expires": "0001-01-01T00:00:00Z", "folderId": 1, "folderTitle": "simcore", "folderUrl": "/grafana/dashboards/f/2Xfg1v5Gz/simcore", "hasAcl": false, "id": "null", "isFolder": false, "provisioned": false, "provisionedExternalId": "Metrics-dashboard.json", "slug": "metrics", "type": "db", "updated": "2021-05-18T06:38:28Z", "updatedBy": "Anonymous", "url": "/grafana/d/X_99jTHWk/metrics", "version": 99}, "panels": [{"collapsed": false, "datasource": null, "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0}, "id": 30, "panels": [], "title": "Simcore usage", "type": "row"}, {"aliasColors": {}, "breakPoint": "50%", "cacheTimeout": null, "combine": {"label": "Others", "threshold": 0}, "datasource": "$Postgresql", "fieldConfig": {"defaults": {"custom": {}, "mappings": [{"id": 0, "op": "=", "text": "N/A", "type": 1, "value": "null"}], "nullValueMode": "connected", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "none"}, "overrides": []}, "fontSize": "150%", "format": "short", "gridPos": {"h": 11, "w": 6, "x": 0, "y": 1}, "id": 14, "interval": null, "legend": {"percentage": true, "show": true, "values": true}, "legendType": "Right side", "links": [], "maxDataPoints": 1, "nullPointMode": "connected", "pieType": "pie", "pluginVersion": "7.0.0", "strokeWidth": 1, "targets": [{"format": "time_series", "group": [{"params": ["$__interval", "none"], "type": "time"}], "metricColumn": "role", "rawQuery": false, "rawSql": "SELECT\n $__timeGroupAlias(created_at,$__interval),\n role AS metric,\n sum(count(id)) OVER (PARTITION BY role ORDER BY $__timeGroup(created_at,$__interval)) AS \"id\"\nFROM users\nWHERE\n role = 'USER'\nGROUP BY 1,2\nORDER BY 1,2", "refId": "A", "select": [[{"params": ["id"], "type": "column"}, {"params": ["count"], "type": "aggregate"}, {"params": ["sum"], "type": "window"}, {"params": ["id"], "type": "alias"}]], "table": "users", "timeColumn": "created_at", "timeColumnType": "timestamp", "where": [{"datatype": "userrole", "name": "", "params": ["role", "=", "'USER'"], "type": "expression"}]}, {"format": "time_series", "group": [{"params": ["$__interval", "none"], "type": "time"}], "metricColumn": "role", "rawQuery": false, "rawSql": "SELECT\n $__timeGroupAlias(created_at,$__interval),\n role AS metric,\n sum(count(id)) OVER (PARTITION BY role ORDER BY $__timeGroup(created_at,$__interval)) AS \"id\"\nFROM users\nWHERE\n role = 'TESTER'\nGROUP BY 1,2\nORDER BY 1,2", "refId": "B", "select": [[{"params": ["id"], "type": "column"}, {"params": ["count"], "type": "aggregate"}, {"params": ["sum"], "type": "window"}, {"params": ["id"], "type": "alias"}]], "table": "users", "timeColumn": "created_at", "timeColumnType": "timestamp", "where": [{"datatype": "userrole", "name": "", "params": ["role", "=", "'TESTER'"], "type": "expression"}]}, {"format": "time_series", "group": [{"params": ["$__interval", "none"], "type": "time"}], "metricColumn": "role", "rawQuery": false, "rawSql": "SELECT\n $__timeGroupAlias(created_at,$__interval),\n role AS metric,\n sum(count(id)) OVER (PARTITION BY role ORDER BY $__timeGroup(created_at,$__interval)) AS \"id\"\nFROM users\nWHERE\n role = 'GUEST'\nGROUP BY 1,2\nORDER BY 1,2", "refId": "C", "select": [[{"params": ["id"], "type": "column"}, {"params": ["count"], "type": "aggregate"}, {"params": ["sum"], "type": "window"}, {"params": ["id"], "type": "alias"}]], "table": "users", "timeColumn": "created_at", "timeColumnType": "timestamp", "where": [{"datatype": "userrole", "name": "", "params": ["role", "=", "'GUEST'"], "type": "expression"}]}], "timeFrom": null, "timeShift": null, "title": "Number of registered Users by type [current]", "type": "grafana-piechart-panel", "valueName": "current"}, {"aliasColors": {}, "bars": false, "cacheTimeout": null, "dashLength": 10, "dashes": false, "datasource": "Prometheus", "decimals": 1, "description": "", "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 0, "fillGradient": 0, "gridPos": {"h": 11, "w": 6, "x": 6, "y": 1}, "hiddenSeries": false, "id": 12, "legend": {"alignAsTable": true, "avg": true, "current": true, "max": true, "min": true, "show": true, "total": false, "values": true}, "lines": true, "linewidth": 3, "links": [], "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "sum by (endpoint) (rate(http_requests_total{endpoint=~\"/v0/me\", http_status=~\"2[0-9]+\", app_name=~\".+webserver\", deployment=\"$deployment\"}[24h]))*60*60*24", "format": "time_series", "instant": false, "interval": "1h", "intervalFactor": 1, "legendFormat": "endpoint: {{endpoint}}", "refId": "B"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Login rate by day", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:76", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:77", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": false}], "yaxis": {"align": false, "alignLevel": null}}, {"cacheTimeout": null, "datasource": null, "fieldConfig": {"defaults": {"custom": {}, "mappings": [], "nullValueMode": "connected", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "none"}, "overrides": []}, "gridPos": {"h": 11, "w": 4, "x": 12, "y": 1}, "id": 36, "links": [], "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": ["last"], "fields": "", "values": false}, "textMode": "auto"}, "pluginVersion": "7.3.3", "targets": [{"expr": "count(redis_key_value{key=~\".+:alive\", deployment=\"$deployment\"})", "interval": "", "legendFormat": "Connected clients", "refId": "A"}, {"expr": "count(redis_key_size{key=~\".+:resources\", deployment=\"$deployment\"})", "interval": "", "legendFormat": "Resources used", "refId": "B"}], "timeFrom": null, "timeShift": null, "title": "Current connections - Redis [current]", "type": "stat"}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": "$Postgresql", "description": "", "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 0, "fillGradient": 0, "gridPos": {"h": 11, "w": 8, "x": 16, "y": 1}, "hiddenSeries": false, "id": 16, "legend": {"alignAsTable": true, "avg": true, "current": true, "max": true, "min": true, "show": true, "total": true, "values": true}, "lines": true, "linewidth": 3, "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"format": "time_series", "group": [{"params": ["$__interval", "none"], "type": "time"}], "metricColumn": "none", "rawQuery": false, "rawSql": "SELECT\n $__timeGroupAlias(created_at,$__interval),\n (CASE WHEN sum(id) >= lag(sum(id)) OVER (ORDER BY $__timeGroup(created_at,$__interval)) THEN sum(id) - lag(sum(id)) OVER (ORDER BY $__timeGroup(created_at,$__interval)) WHEN lag(sum(id)) OVER (ORDER BY $__timeGroup(created_at,$__interval)) IS NULL THEN NULL ELSE sum(id) END)/extract(epoch from min(created_at) - lag(min(created_at)) OVER (ORDER BY $__timeGroup(created_at,$__interval))) AS \"id\"\nFROM users\nWHERE\n $__timeFilter(created_at)\nGROUP BY 1\nORDER BY 1", "refId": "A", "select": [[{"params": ["id"], "type": "column"}, {"params": ["sum"], "type": "aggregate"}, {"params": ["rate"], "type": "window"}, {"params": ["id"], "type": "alias"}]], "table": "users", "timeColumn": "created_at", "timeColumnType": "timestamp", "where": [{"name": "$__timeFilter", "params": [], "type": "macro"}]}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "New users per second [time]", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": false}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "cacheTimeout": null, "dashLength": 10, "dashes": false, "datasource": null, "decimals": 0, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 0, "fillGradient": 1, "gridPos": {"h": 10, "w": 12, "x": 0, "y": 21}, "hiddenSeries": false, "id": 18, "legend": {"alignAsTable": true, "avg": true, "current": true, "hideEmpty": false, "hideZero": false, "max": false, "min": false, "rightSide": true, "show": true, "sort": "current", "sortDesc": true, "total": false, "values": true}, "lines": true, "linewidth": 3, "links": [], "nullPointMode": "null as zero", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [{"$$hashKey": "object:669", "alias": ""}], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "sum by (service_name) (label_replace(container_tasks_state:count_by_image, \"service_name\", \"$3\", \"image\", \".*/simcore/services/(dynamic|comp)/([a-zA-Z0-9]*/)?(.*)\"))", "instant": false, "interval": "", "legendFormat": "{{service_name}}", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Number of services running by version [time]", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"format": "short", "label": null, "logBase": 10, "max": null, "min": null, "show": true}, {"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "cacheTimeout": null, "dashLength": 10, "dashes": false, "datasource": null, "decimals": 0, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 0, "fillGradient": 1, "gridPos": {"h": 10, "w": 12, "x": 12, "y": 21}, "hiddenSeries": false, "id": 40, "legend": {"alignAsTable": true, "avg": true, "current": true, "hideEmpty": true, "hideZero": true, "max": false, "min": false, "rightSide": true, "show": true, "sort": "current", "sortDesc": true, "total": false, "values": true}, "lines": true, "linewidth": 2, "links": [], "nullPointMode": "null as zero", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [{"alias": ""}], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "label_replace(rate({__name__=~\"simcore_simcore_service_(director|webserver)_services_started_total:sum_by_service_key_service_tag\", deployment=\"$deployment\"}[$__range])*$__range_ms/1000, \"service_name\", \"$3\", \"service_key\", \"simcore/services/(dynamic|comp)/([a-zA-Z0-9]*/)?(.*)\")", "instant": false, "interval": "", "legendFormat": "{{service_name}}:{{service_tag}}", "refId": "B"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Service started [time]", "tooltip": {"shared": true, "sort": 2, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"format": "short", "label": null, "logBase": 10, "max": null, "min": null, "show": true}, {"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": null, "decimals": 2, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 1, "fillGradient": 0, "gridPos": {"h": 7, "w": 12, "x": 0, "y": 31}, "hiddenSeries": false, "id": 42, "legend": {"alignAsTable": true, "avg": true, "current": false, "hideEmpty": true, "hideZero": true, "max": true, "min": true, "rightSide": true, "show": true, "sort": "avg", "sortDesc": true, "total": false, "values": true}, "lines": true, "linewidth": 1, "links": [], "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 5, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": true, "steppedLine": false, "targets": [{"expr": "sum(label_replace(irate(container_cpu_usage_seconds_total{container_label_com_docker_swarm_node_id=~\"$node_id\", id=~\"/docker/.*\", container_label_com_docker_swarm_service_name=~\"$deployment-.*simcore.*\"}[1m]), \"service_name\", \"$1\", \"container_label_com_docker_swarm_service_name\", \".*_(.*)\")) by (service_name) test.bash 100", "format": "time_series", "instant": false, "interval": "", "intervalFactor": 2, "legendFormat": "{{service_name}}", "refId": "C", "step": 2}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "CPU usage by Service", "tooltip": {"shared": true, "sort": 2, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"format": "percent", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": false}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "cacheTimeout": null, "dashLength": 10, "dashes": false, "datasource": null, "decimals": 0, "fieldConfig": {"defaults": {"custom": {}, "links": [], "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": []}, "fill": 0, "fillGradient": 1, "gridPos": {"h": 10, "w": 12, "x": 12, "y": 31}, "hiddenSeries": false, "id": 43, "legend": {"alignAsTable": true, "avg": true, "current": true, "hideEmpty": true, "hideZero": true, "max": false, "min": false, "rightSide": true, "show": true, "sort": "current", "sortDesc": true, "total": false, "values": true}, "lines": true, "linewidth": 2, "links": [], "nullPointMode": "null as zero", "options": {"alertThreshold": true}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [{"alias": ""}], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "label_replace(increase({__name__=~\"simcore_simcore_service_(director|webserver)_services_started_total:sum_by_service_key_service_tag\", deployment=\"$deployment\"}[24h]), \"service_name\", \"$3\", \"service_key\", \"simcore/services/(dynamic|comp)/([a-zA-Z0-9]*/)?(.*)\")", "interval": "", "legendFormat": "{{service_name}}:{{service_tag}}", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Service started / day [time]", "tooltip": {"shared": true, "sort": 2, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:797", "format": "short", "label": null, "logBase": 10, "max": null, "min": null, "show": true}, {"$$hashKey": "object:798", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"collapsed": false, "datasource": null, "gridPos": {"h": 1, "w": 24, "x": 0, "y": 41}, "id": 32, "panels": [], "title": "Cluster usage", "type": "row"}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": null, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 1, "fillGradient": 0, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 42}, "hiddenSeries": false, "id": 27, "interval": "", "legend": {"alignAsTable": true, "avg": false, "current": true, "max": false, "min": false, "rightSide": false, "show": true, "total": false, "values": true}, "lines": true, "linewidth": 1, "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": true, "renderer": "flot", "seriesOverrides": [{"$$hashKey": "object:419", "alias": "increase cpu hours", "yaxis": 2}, {"$$hashKey": "object:966", "alias": "increase cpu hours range", "yaxis": 2}], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "sum(increase(node_cpu_seconds_total:nonidle_sum_over_nodes[$__range]))/3600", "format": "time_series", "hide": false, "instant": false, "interval": "1h", "intervalFactor": 1, "legendFormat": "increase cpu hours over selected range", "refId": "C"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Total CPU consumption over all nodes [cpu-hours]", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:330", "format": "none", "label": "", "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:331", "format": "short", "label": "", "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": null, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 1, "fillGradient": 0, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 42}, "hiddenSeries": false, "id": 28, "interval": "", "legend": {"alignAsTable": true, "avg": false, "current": true, "max": true, "min": true, "rightSide": false, "show": true, "total": false, "values": true}, "lines": true, "linewidth": 1, "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": true, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "sum(node_filesystem_size_bytes{mountpoint=~\"/.*\", device!~'rootfs'} - node_filesystem_avail_bytes{mountpoint=~\"/.*\", device!~'rootfs'})", "interval": "1h", "intervalFactor": 1, "legendFormat": "data usage", "refId": "B"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Overall data storage [GB]", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"format": "bytes", "label": "", "logBase": 1, "max": null, "min": null, "show": true}, {"format": "short", "label": "", "logBase": 1, "max": null, "min": null, "show": false}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": null, "fieldConfig": {"defaults": {"custom": {}, "links": []}, "overrides": []}, "fill": 2, "fillGradient": 3, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 50}, "hiddenSeries": false, "id": 25, "legend": {"alignAsTable": true, "avg": true, "current": true, "max": true, "min": true, "rightSide": true, "show": true, "total": false, "values": true}, "lines": true, "linewidth": 2, "nullPointMode": "null", "options": {"dataLinks": []}, "percentage": false, "pluginVersion": "7.3.3", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": false, "steppedLine": false, "targets": [{"expr": "100 - (avg(irate(node_cpu_seconds_total{job=\"node-exporter\",mode=\"idle\"}[$__range]) test.bash on(instance) group_left(node_name) node_meta{}) by (node_name) test.bash 100)", "interval": "", "legendFormat": "{{node_name}}", "refId": "A"}], "thresholds": [{"colorMode": "warning", "fill": true, "line": false, "op": "gt", "value": 90, "yaxis": "left"}], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "CPU consumption per node [time]", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"decimals": null, "format": "percent", "label": null, "logBase": 1, "max": "100", "min": "0", "show": true}, {"format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"datasource": null, "fieldConfig": {"defaults": {"custom": {}, "mappings": [], "max": 1, "min": 0, "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 0.85}, {"color": "red", "value": 0.95}]}, "unit": "percentunit"}, "overrides": []}, "gridPos": {"h": 8, "w": 6, "x": 12, "y": 50}, "id": 22, "options": {"displayMode": "lcd", "orientation": "horizontal", "reduceOptions": {"calcs": ["mean"], "values": false}, "showUnfilled": true}, "pluginVersion": "7.3.3", "targets": [{"expr": "sort_desc(1 - sum(node_filesystem_avail_bytes{mountpoint=~\"/\", device!~'rootfs'}/node_filesystem_size_bytes{mountpoint=~\"/\", device!~'rootfs'} test.bash on(instance) group_left(node_name) node_meta{}) by (node_name))", "instant": true, "interval": "", "legendFormat": "{{node_name}}", "refId": "B"}], "timeFrom": null, "timeShift": null, "title": "Used disk space [current]", "type": "bargauge"}, {"cacheTimeout": null, "datasource": null, "fieldConfig": {"defaults": {"custom": {"align": null}, "mappings": [], "min": 0, "thresholds": {"mode": "percentage", "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 5}, {"color": "green", "value": 15}]}, "unit": "decgbytes"}, "overrides": [{"matcher": {"id": "byName", "options": "OsparcDalco1"}, "properties": [{"id": "max", "value": 374}]}, {"matcher": {"id": "byName", "options": "OsparcDalco2"}, "properties": [{"id": "max", "value": 374}]}, {"matcher": {"id": "byName", "options": "OsparcDalco3"}, "properties": [{"id": "max", "value": 374}]}, {"matcher": {"id": "byName", "options": "OsparcDalco4"}, "properties": [{"id": "max", "value": 374}]}, {"matcher": {"id": "byName", "options": "OsparcDalco5"}, "properties": [{"id": "max", "value": 374}]}, {}]}, "gridPos": {"h": 8, "w": 6, "x": 18, "y": 50}, "id": 23, "interval": null, "links": [], "maxDataPoints": 1, "options": {"displayMode": "gradient", "orientation": "horizontal", "reduceOptions": {"calcs": ["last"], "fields": "", "values": false}, "showUnfilled": true}, "pluginVersion": "7.3.3", "targets": [{"expr": "sort(sum(node_filesystem_avail_bytes{mountpoint=~\"/\", device!~'rootfs'} /1024/1024/1024 test.bash on(instance) group_left(node_name) node_meta{}) by (node_name))", "instant": true, "interval": "", "legendFormat": "{{node_name}}", "refId": "B"}, {"expr": "sum(node_filesystem_size_bytes{mountpoint=~\"/\", device!~'rootfs'} /1024/1024/1024 test.bash on(instance) group_left(node_name) node_meta{}) by (node_name)", "hide": true, "interval": "", "legendFormat": "{{node_name}}_total", "refId": "A"}], "timeFrom": null, "timeShift": null, "title": "Available disk space [current]", "type": "bargauge"}], "refresh": "30s", "schemaVersion": 26, "style": "dark", "tags": [], "templating": {"list": [{"allValue": null, "current": {"selected": true, "text": "production", "value": "production"}, "error": null, "hide": 0, "includeAll": false, "label": "Deployment", "multi": false, "name": "deployment", "options": [{"selected": true, "text": "production", "value": "production"}, {"selected": false, "text": "staging", "value": "staging"}], "query": "production, staging", "queryValue": "", "skipUrlSync": false, "type": "custom"}, {"current": {"selected": false, "text": "ProductionPostgres", "value": "ProductionPostgres"}, "error": null, "hide": 2, "includeAll": false, "label": null, "multi": false, "name": "Postgresql", "options": [], "query": "postgres", "refresh": 1, "regex": "/^($deployment).*/i", "skipUrlSync": false, "type": "datasource"}, {"allValue": ".+", "current": {"selected": false, "text": "All", "value": "$__all"}, "datasource": "Prometheus", "definition": "node_meta", "error": null, "hide": 0, "includeAll": true, "label": "Swarm node", "multi": false, "name": "node_id", "options": [], "query": "node_meta", "refresh": 1, "regex": "/node_id=\"([^\"]+)\"/", "skipUrlSync": false, "sort": 1, "tagValuesQuery": "label_values({node_id=\"$tag\"},node_name)", "tags": [{"selected": false, "text": "osparc-dalco-02"}, {"selected": false, "text": "osparc-dalco-01"}, {"selected": false, "text": "osparc-dalco-03"}, {"selected": false, "text": "osparc-dalco-06"}, {"selected": false, "text": "osparc-dalco-05"}, {"selected": false, "text": "osparc-dalco-04"}], "tagsQuery": "label_values(node_meta, node_name)", "type": "query", "useTags": true}]}, "time": {"from": "now-30m", "to": "now"}, "timepicker": {"refresh_intervals": ["10s", "30s", "1m", "5m", "15m", "30m", "1h", "2h", "1d"], "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]}, "timezone": "browser", "title": "Metrics", "uid": "X_99jTHWk", "version": 2}}